import{r as l,j as n,c as b,R as U}from"./index-DUboM-Ei.js";import{C as G}from"./Component-BVQItUUo.js";import{d as M,I as E,g as O}from"./index-Dw4fpHSx.js";import"./prism-tsx-BjGe-lSY.js";function D({style:T,className:F,multiple:s,defaultValue:H,value:L,onChangeValue:W,options:a,open:_,onChangeOpen:$,optionsMaxHeight:q,before:B,after:K,children:C,tagRender:R,...d}){const S=l.useRef(null),u=l.useRef(null),[r,g]=M(L,W,H??(s?[]:"")),[i,o]=M(_,$),[m,y]=l.useState(""),[P,v]=l.useState(!1),[h,k]=l.useState(0),x=l.useRef(!1),j=l.useMemo(()=>!s&&(a==null?void 0:a.find(e=>e.value===r))||null,[a,r,s]),p=l.useMemo(()=>s&&(a==null?void 0:a.filter(e=>r.includes(e.value)))||[],[a,r,s]),c=l.useMemo(()=>(a==null?void 0:a.filter(e=>!m||e.label.includes(m)))||[],[a,m]);l.useEffect(()=>{if(i)v(!1);else{v(!0);const e=window.setTimeout(()=>{y(""),v(!1)},300);return()=>window.clearTimeout(e)}},[i]),l.useEffect(()=>{i&&N(0)},[i,c]),l.useEffect(()=>{if(i){const e=document.querySelector(".ui-select-hover");e&&e.scrollIntoView({block:"nearest"})}},[h]),l.useEffect(()=>{var e;p.length||(e=u.current)==null||e.removeAttribute("style")},[p]);const w=e=>{if(s){const t=r;t.includes(e)?g(t.filter(f=>f!==e)):g([...t,e])}else g(e)},N=e=>{let t=(h+e)%c.length;e===0&&(t=c.findLastIndex(f=>p.includes(f)),t===-1&&(t+=1));for(let f=0;f<c.length;f++){const I=c[t];if(I&&!I.disabled)break;t+=e>0?1:-1,t<0?t=c.length:t>c.length&&(t=0)}k(t)};return n.jsxs("label",{className:b("ui-input ui-input-box ui-select",{"ui-select-multiple":s,"ui-select-open":i},F),style:T,tabIndex:-1,ref:S,onMouseDown:e=>{var t;(t=S.current)!=null&&t.contains(e.target)&&o(!i)},onClick:()=>{var e;return(e=u.current)==null?void 0:e.focus()},children:[B,n.jsx("input",{...d,type:"hidden",value:r}),n.jsxs("div",{className:b({"ui-select-tags":p.length}),onMouseDown:e=>{e.target!==u.current&&(e.stopPropagation(),x.current=!0)},children:[p.map(e=>n.jsx(U.Fragment,{children:R?R(e):n.jsxs("span",{className:"ui-select-tag",children:[n.jsx("span",{children:e.label}),n.jsx(E,{className:"ui-input-icon",size:16,onClick:()=>w(e.value),children:"close"})]})},e.value)),n.jsx("input",{ref:u,className:b("ui-select-search",{"ui-select-has-value":r}),value:P?"":m,onChange:e=>{if(y(e.target.value),o(!0),p.length){const t=document.createElement("span");t.textContent=e.target.value,document.body.appendChild(t),u.current&&(u.current.style.width=`${t.offsetWidth}px`),t.remove()}},disabled:d.disabled,placeholder:!s&&(j==null?void 0:j.label)||d.placeholder,onBlur:()=>{var e;if(x.current){x.current=!1,(e=u.current)==null||e.focus();return}o(!1)},onKeyDown:e=>{if(e.key==="Enter"||e.key.startsWith("Arrow")?o(!0):e.key==="Escape"&&o(!1),i){if(e.key==="ArrowUp")N(-1);else if(e.key==="ArrowDown")N(1);else if(e.key==="Enter"){const t=c[h];t&&(w(t.value),y("")),s||o(!1)}}}})]}),K||n.jsx(E,{className:"ui-input-icon",children:"keyboard_arrow_down"}),n.jsx(O,{open:i,children:n.jsx(O.Content,{className:"ui-select-dropdown",onMouseDown:()=>x.current=!0,children:c.length?n.jsx("div",{className:"ui-select-options",style:{maxHeight:q},children:c.map((e,t)=>n.jsx("div",{className:b({"ui-select-hover":t===h&&!(d.disabled||e.disabled),"ui-select-active":s?r.includes(e.value):e.value===r,"ui-select-disabled":d.disabled||e.disabled}),onMouseEnter:()=>k(t),onClick:()=>{d.disabled||e.disabled||(w(e.value),s||o(!1))},children:C?C(e):n.jsxs(n.Fragment,{children:[n.jsx("span",{children:e.label}),s&&r.includes(e.value)&&n.jsx(E,{className:"ui-input-icon",size:16,children:"check"})]})},e.value))}):n.jsx("div",{className:"ui-select-no-data",children:"No data"})})})]})}const A="Select",J=[{name:A,wraps:"input/hidden",props:[{prop:"options",type:"Select.Option[]"},{prop:"defaultValue",type:"string | string[]"},{prop:"value",type:"string | string[]"},{prop:"onChangeValue",type:"(value: string | string[]) => any"},{prop:"open",type:"boolean",defaultValue:!1},{prop:"onChangeOpen",type:"(open: boolean) => any"},{prop:"multiple",type:"boolean",defaultValue:!1},{prop:"optionsMaxHeight",type:"number"},{prop:"before",type:"React.ReactNode"},{prop:"after",type:"React.ReactNode"},{prop:"children",type:"(option: Option) => React.ReactNode"},{prop:"tagRender",type:"(option: Option) => React.ReactNode"}]},{name:"Select.Option",props:[{prop:"value",type:"string"},{prop:"label",type:"string"},{prop:"disabled",type:"boolean",defaultValue:!1}]}],V=`
import { Select } from '@zenmi/ui'

export function Example() {
  const options: Select.Option[] = [
    { value: '1', label: 'option 1' },
    { value: '2', label: 'option 2' },
    { value: '3', label: 'option 3' }
  ]

  return (
    <Select options={options} />
  )
}
`,z=[{value:"1",label:"option 1"},{value:"2",label:"option 2"},{value:"3",label:"option 3"}];function Q(){return n.jsx(D,{options:z})}function X(){return n.jsx(D,{options:z,multiple:!0})}function ne(){return n.jsx(G,{title:A,examples:[{name:"Single",code:V,element:n.jsx(Q,{}),center:!0},{name:"Multiple",code:V.replace(/(\/>)/,"multiple $1"),element:n.jsx(X,{}),center:!0}],apiItems:J})}export{ne as default};
